<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="semantic.min.css" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="tab.css" />

    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="tmi.min.js"></script>

    <!-- Insert this line above script imports  -->
    <script>
      if (typeof module === "object") {
        window.module = module;
        module = undefined;
      }
    </script>

    <!-- normal script imports etc  -->
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"
      type="text/javascript"
    ></script>

    <!-- Insert this line after script imports -->
    <script>
      if (window.module) module = window.module;
    </script>

    <script src="https://unpkg.com/vue-tippy/dist/vue-tippy.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-tippy/dist/vue-tippy.min.js"></script>

    <script src="moment.js"></script>
    <script src="moment-duration-format.js"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <title>Booyah! videos</title>
  </head>
  <body>
    <div id="app">
      <div id="notification" class="hidden">
        <p id="message"></p>
        <button id="close-button" onClick="closeNotification()">
          Close
        </button>
        <button id="restart-button" onClick="restartApp()" class="hidden">
          Restart
        </button>
      </div>

      <div class="ui inverted top attached tabular menu">
        <div
          @click="setTab(tab) "
          v-for="(tab,index) in tabs"
          :class="{ active: currentTab==tab }"
          class="item"
        >

          {{tab}} 

        </div>
    </div>
    </br></br>
      <div 
        v-if=" ( (currentTab=='Videos' && video.watchlater == false && ( shortvideos == true || shortvideos == false && video.durationSecounds > 60) ) ||
               (currentTab=='Ver más tarde' && video.watchlater == true) ) &&
                
                (showWatchedInSession==true || (showWatchedInSession==false && !video.watched))
               "

                class="ui card" :class="{ watched: video.watched }" v-for="(video,index) in reversevideos">
        <div class="image">
         
          <i v-if="currentTab=='Videos' && !video.watched" @click="addToWatchlater(video.id)" content="Ver más tarde" v-tippy class="watchlater fas fa-stopwatch"></i>
          <i v-if="currentTab=='Ver más tarde' && !video.watched" @click="removeFromWatchlater(video.id)" content="Quitar de ver mas tarde" v-tippy class="watchlater fas fa-times"></i>
          
          <a @click="markVideoAsWatched(video.id)" :href="video.url" target="_blank">
            <img :src="video.thumbnail_url" />
          </a>
        </div>
        <div class="content">
          <a @click="markVideoAsWatched(video.id)" :href="video.url" target="_blank" class="header"
            >{{video.title}}</a
          >
          <p class="info-row">

            <span v-if="video.views" content="Visitas" v-tippy :class="{ 'warning-color': video.views < 100}" class="info views">
              <i v-if="video.views >= 100" class="fas fa-eye"></i>
              <i
                v-if="video.views < 100"
                title="Tiene pocas views, puede ser contenido baneable."
                class="warning-color fas fa-exclamation-triangle"
              ></i>
              {{ new Intl.NumberFormat("es-CL").format(video.views) }}
            </span>

            <span v-if="video.durationFormated" content="Duracion" v-tippy class="info duration"
              ><i class="far fa-clock"></i>{{ video.durationFormated }} {{video.durationFormated.length < 3 ? 's':''}}</span
            >
            <span v-if="video.publishedAt" content="Fecha de creacion" v-tippy class="info date"
              ><i class="fas fa-calendar-alt"></i>{{ video.publishedAt }}</span
            >
            <span content="Canal" v-tippy class="info channel"
              ><i class="youtube fab fa-youtube"></i>{{ video.channel }}</span
            >
            <span :content="'Enviado desde '+video.platform" v-tippy class="info author"
              >
              
              <img v-if="video.platform == 'twitch'" class="platform" src="twitch-icon.png"></img>
              <img v-if="video.platform == 'booyah'" class="platform" src="booyah-icon.png"></img>

              {{video.author }}</span
            >
            <span v-if="video.likeratio" content="Likes" v-tippy class="info likeratio"
              ><i v-if="video.likeratio > 85" class="good fas fa-thumbs-up"></i>
               <i v-if="video.likeratio <= 85" class="bad fas fa-thumbs-down"></i>{{video.likeratio}}%</span
            >
            <!-- <img @click="banvideo(video.id)" class="ban" src="ban.png"> </img> -->
          </p>
        </div>
      </div>



      <div 
      v-if=" currentTab=='Productos' && stores.includes(product.store) &&
            (showWatchedInSession==true || (showWatchedInSession==false && !product.watched))
             "

              class="ui card" :class="{ watched: product.watched }" v-for="(product,index) in reverseproducts">
      <div class="image">
       
        <a @click="markProductAsWatched(product.title)" :href="product.url" target="_blank">
          <img :src="product.img" />
        </a>
      </div>
      <div class="content">
        <a @click="markProductAsWatched(product.title)" :href="product.url" target="_blank" class="header"
          >{{product.title}}</a
        >
        <p class="info-row">
          <span v-if="product.priceCLP" content="Precio en CLP" v-tippy class="info price">
            <i class="fas fa-tag"></i>{{ new Intl.NumberFormat('es-CL', {style: 'currency',currency: 'CLP'}).format(product.priceCLP)}} pesos
          </span>

          <span v-if="product.priceUSD" content="Precio en Dolares Estadounidences" v-tippy class="info price">
            <i class="fas fa-tag"></i>{{ new Intl.NumberFormat('en-US', {style: 'currency',currency: 'USD'}).format(product.priceUSD)}} dolares
          </span>
          
          <span v-if="product.category" content="Categoria" v-tippy class="info price">
            <i class="fas fa-tag"></i>{{ product.category }}
          </span>
        

            <span content="Tienda" v-tippy class="info store">
              <i class="fas fa-store-alt"></i>{{ product.storeReadeable }}
            </span>
         </p>
      </div>
    </div>

    </div>

    <script src="./render.js"></script>
  </body>
</html>
